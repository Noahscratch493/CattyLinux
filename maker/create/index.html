<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Linux Maker</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Favicon -->
  <link rel="icon" href="https://cattymod.github.io/linux/assets/logo.png" />

  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />

  <!-- Monaco Editor -->
  <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.41.0/min/vs/loader.js"></script>

  <style>
    html, body {
      margin: 0; padding: 0; height: 100%;
      background-color: #0d1117;
      color: #c9d1d9;
      font-family: system-ui, sans-serif;
    }
    #monacoEditor {
      width: 100%;
      height: 100%;
      background-color: #161b22;
      border-radius: 0.375rem;
    }

    /* Overlay styles */
    #overlay {
      position: fixed;
      inset: 0;
      background: rgba(13,17,23,0.9);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    #overlayContent {
      background: #161b22;
      padding: 2rem;
      border-radius: 0.5rem;
      max-width: 450px;
      width: 90%;
      box-shadow: 0 0 15px rgba(88,166,255,0.6);
      position: relative;
      color: #c9d1d9;
      font-size: 1rem;
      line-height: 1.5;
    }

    #overlayContent h3 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      color: #58a6ff;
      font-weight: 600;
    }

    #overlayClose {
      position: absolute;
      top: 0.5rem;
      right: 0.75rem;
      font-size: 1.5rem;
      font-weight: 700;
      color: #c9d1d9;
      cursor: pointer;
      user-select: none;
      transition: color 0.2s ease;
    }

    #overlayClose:hover {
      color: #ff7b72;
    }
  </style>
</head>
<body class="flex flex-col min-h-screen">

  <!-- Navbar -->
  <nav class="flex justify-between items-center px-6 py-3 border-b border-[#30363d]">
    <div class="flex items-center gap-3 text-[#7d8590] text-sm font-semibold uppercase tracking-wider">
      <i class="fas fa-terminal"></i> Linux Maker
    </div>
    <div class="text-[#7d8590] text-sm select-none">cattymod.github.io/linux</div>
  </nav>

  <div class="flex flex-1 overflow-hidden">

    <!-- Sidebar -->
    <aside class="bg-[#0d1117] border-r border-[#30363d] w-64 overflow-auto">
      <div class="p-5">
        <h3 class="text-[#f0f6fc] font-semibold mb-4 text-base">Quick Commands</h3>
        <select
          id="categorySelect"
          class="w-full mb-4 bg-[#161b22] border border-[#30363d] rounded-md px-3 py-2 text-sm text-[#c9d1d9] focus:outline-none focus:ring-2 focus:ring-[#58a6ff]"
        >
          <option value="Basic">Basic</option>
          <option value="Debian">Debian</option>
          <option value="Package Management">Package Management</option>
          <option value="Arch Linux">Arch Linux</option>
          <option value="Void">Void</option>
          <option value="Advanced">Advanced</option>
        </select>
        <div id="commandsContainer" class="flex flex-col gap-2"></div>
      </div>
    </aside>

    <!-- Main -->
    <main class="flex-1 flex flex-col overflow-hidden">

      <!-- Editor -->
      <section id="editorSection" class="flex flex-col flex-1">
        <header class="px-8 pt-8 pb-6 border-b border-[#30363d]">
          <h2 class="text-[#f0f6fc] font-semibold text-2xl mb-2">Build Your Linux Distribution</h2>
          <p class="text-[#7d8590] text-base">
            Use <code class="text-[#ff7b72] font-mono">RunCommand("...")</code>, <code class="text-[#ff7b72] font-mono">InstallPackage("...")</code>, and <code class="text-[#ff7b72] font-mono">echo("...")</code>
          </p>
        </header>

        <div class="flex-1 px-8 py-4">
          <div id="monacoEditor"></div>
        </div>

        <div class="px-8 py-6 border-t border-[#30363d] flex justify-center">
          <button
            id="buildBtn"
            class="bg-green-700 hover:bg-green-600 transition-colors text-white py-3 px-7 rounded-md font-medium flex items-center gap-2"
          >
            <i class="fas fa-rocket"></i> Build Distribution
          </button>
        </div>
      </section>

      <!-- Distro Choice -->
      <section
        id="distroChoice"
        class="hidden flex-col items-center justify-center p-12 text-center text-[#f0f6fc]"
      >
        <h2 class="text-3xl font-semibold mb-6">Choose Base Distribution</h2>
        <div class="flex flex-wrap gap-6 justify-center">
          <button class="distroBtn" data-distro="Debian">
            <i class="fab fa-ubuntu text-4xl mb-2"></i>
            <div>Debian</div>
          </button>
          <button class="distroBtn" data-distro="Arch Linux">
            <i class="fab fa-linux text-4xl mb-2"></i>
            <div>Arch Linux</div>
          </button>
          <button class="distroBtn" data-distro="Fedora">
            <i class="fab fa-fedora text-4xl mb-2"></i>
            <div>Fedora</div>
          </button>
          <button class="distroBtn" data-distro="Alpine">
            <i class="fas fa-mountain text-4xl mb-2"></i>
            <div>Alpine</div>
          </button>
          <button class="distroBtn" data-distro="Void">
            <i class="fas fa-circle-notch text-4xl mb-2"></i>
            <div>Void Linux</div>
          </button>
          <button class="distroBtn" data-distro="openSUSE">
            <i class="fa-brands fa-opensuse text-4xl mb-2"></i>
            <div>openSUSE</div>
          </button>
        </div>
        <button
          id="backToEditor"
          class="mt-8 border border-[#30363d] text-[#7d8590] px-4 py-2 rounded-md hover:bg-[#30363d]"
        >
          <i class="fas fa-arrow-left"></i> Back to Editor
        </button>
      </section>

      <!-- Output -->
      <section
        id="generatedSection"
        class="hidden p-12 text-center text-[#f0f6fc] flex flex-col items-center"
      >
        <h2 class="text-3xl font-semibold mb-6 flex items-center gap-2">
          <i class="fas fa-terminal text-[#58a6ff]"></i> Generated Command
        </h2>
        <div class="mb-4 font-semibold text-lg w-full max-w-3xl text-left" id="distroName"></div>
        <pre
          id="generatedCommand"
          class="bg-[#161b22] border border-[#30363d] p-4 rounded-md max-w-3xl w-full text-left text-sm font-mono whitespace-pre-wrap"
        ></pre>
        <div
          class="mt-6 flex items-center justify-center gap-4 flex-wrap text-sm max-w-3xl w-full"
        >
          <button
            id="copyBtn"
            class="bg-green-700 hover:bg-green-600 text-white px-4 py-2 rounded-md flex items-center gap-1"
          >
            <i class="fas fa-copy"></i> Copy Command
          </button>

          <button
            id="createAnotherBtn"
            class="bg-blue-700 hover:bg-blue-600 text-white px-4 py-2 rounded-md flex items-center gap-1"
          >
            <i class="fas fa-redo"></i> Create Another
          </button>

          <span class="text-[#7d8590] select-none">|</span>

          <button
            id="testDistroBtn"
            class="bg-purple-700 hover:bg-purple-600 text-white px-4 py-2 rounded-md flex items-center gap-1"
          >
            <i class="fas fa-vial"></i> Test my distro
          </button>
        </div>
      </section>

    </main>
  </div>

<!-- Overlay -->
<div id="overlay" class="flex">
  <div id="overlayContent">
    <div id="overlayClose" title="Close overlay">&times;</div>
    <h3>Test Your Distro</h3>
    <p>
      To test your custom Linux commands using <a href="https://distrosea.com/" target="_blank" rel="noopener" class="text-[#58a6ff] underline">DistroSea</a>:
    </p>
    <ol class="list-decimal list-inside mt-2 space-y-2 text-sm text-[#c9d1d9]">
      <li>Go to DistroSea and select a base distribution that matches or is closest to your chosen distro. For example, if you chose <strong>Debian</strong>, pick <strong>Ubuntu</strong>.</li>
      <li>Launch the chosen distribution’s live environment.</li>
      <li>Open the terminal application inside DistroSea.</li>
      <li>Copy the generated command from this app and paste it into the terminal.</li>
      <li>Run the command to see your custom Linux environment in action.</li>
    </ol>
    <p class="mt-4">
      This lets you safely experiment with your Linux build without affecting your main system.
    </p>
  </div>
</div>


  <!-- Disclaimer -->
  <div class="text-center text-[#7d8590] text-xs py-2 border-t border-[#30363d]">
    Not affiliated with any Linux distribution mentioned.
  </div>

  <!-- Footer -->
  <footer
    class="bg-[#161b22] border-t border-[#30363d] text-center p-4 text-[#7d8590] text-sm"
  >
    <i class="fas fa-code mr-1"></i> Powered by Monaco Editor • Built with ❤️ by CattyMod
  </footer>

  <!-- JavaScript -->
  <script>
    require.config({ paths: { vs: 'https://cdn.jsdelivr.net/npm/monaco-editor@0.41.0/min/vs' } });
    let editor;

    require(['vs/editor/editor.main'], function () {
      editor = monaco.editor.create(document.getElementById('monacoEditor'), {
        value: '',
        language: 'shell',
        theme: 'vs-dark',
        fontSize: 14,
        minimap: { enabled: false },
        wordWrap: 'on',
        automaticLayout: true,
        lineNumbers: 'on'
      });
    });

    // Quick commands grouped by category
    const quickCommandsByCategory = {
      "Basic": [
        'RunCommand("echo Hello, Linux!")',
        'RunCommand("uname -a")',
        'RunCommand("lsb_release -a")',
        'echo("Welcome to your new Linux!")'
      ],
      "Debian": [
        'RunCommand("sudo apt update")',
        'RunCommand("sudo apt upgrade -y")',
        'RunCommand("sudo apt remove -y package_name")',
        'RunCommand("sudo apt autoremove -y")'
      ],
      "Package Management": [
        'InstallPackage("curl")',
        'InstallPackage("git")',
        'InstallPackage("firefox")',
        'InstallPackage("vim")'
      ],
      "Arch Linux": [
        'RunCommand("sudo pacman -Syu --noconfirm")',
        'RunCommand("sudo pacman -S --noconfirm package_name")',
        'RunCommand("sudo pacman -Rns package_name")'
      ],
      "Void": [
        'RunCommand("sudo xbps-install -Syu")',
        'RunCommand("sudo xbps-install -Sy package_name")',
        'RunCommand("sudo xbps-remove -R package_name")'
      ],
      "Advanced": [
        'RunCommand("make")',
        'RunCommand("sudo systemctl restart networking")',
        'RunCommand("sudo journalctl -xe")'
      ]
    };

    const commandsContainer = document.getElementById("commandsContainer");
    const categorySelect = document.getElementById("categorySelect");

    function loadCommands(category) {
      commandsContainer.innerHTML = '';
      const cmds = quickCommandsByCategory[category] || [];
      cmds.forEach(cmd => {
        const btn = document.createElement("button");
        btn.textContent = cmd;
        btn.className = "w-full text-left bg-[#161b22] border border-[#30363d] rounded-md px-4 py-2 text-sm hover:bg-[#30363d] font-mono";
        btn.onclick = () => {
          const val = editor.getValue();
          editor.setValue(val + (val.trim() ? "\n" : "") + cmd);
        };
        commandsContainer.appendChild(btn);
      });
    }

    categorySelect.onchange = (e) => loadCommands(e.target.value);
    loadCommands(categorySelect.value);

    // Show/hide sections helper
    const editorSection = document.getElementById("editorSection");
    const distroChoice = document.getElementById("distroChoice");
    const generatedSection = document.getElementById("generatedSection");
    const generatedCommand = document.getElementById("generatedCommand");
    const distroName = document.getElementById("distroName");

    function show(section) {
      [editorSection, distroChoice, generatedSection].forEach(s => (s.style.display = "none"));
      section.style.display = "flex";
      section.style.flexDirection = "column";
    }

    document.getElementById("buildBtn").onclick = () => {
      show(distroChoice);
    };

    document.querySelectorAll(".distroBtn").forEach(btn => {
      btn.onclick = () => {
        const distro = btn.dataset.distro;
        distroName.textContent = `Base Distribution: ${distro}`;

        // Parse editor commands and convert
        const lines = editor.getValue().split("\n").map(l => l.trim()).filter(Boolean);
        let shellScriptLines = [];

        lines.forEach(line => {
          // RunCommand("...")
          let rcMatch = line.match(/^RunCommand\("(.+)"\)$/);
          if (rcMatch) {
            shellScriptLines.push(rcMatch[1]);
            return;
          }

          // InstallPackage("...")
          let ipMatch = line.match(/^InstallPackage\("(.+)"\)$/);
          if (ipMatch) {
            let pkg = ipMatch[1];
            if (distro === "Debian") shellScriptLines.push(`sudo apt install -y ${pkg}`);
            else if (distro === "Arch Linux") shellScriptLines.push(`sudo pacman -S --noconfirm ${pkg}`);
            else if (distro === "Void") shellScriptLines.push(`sudo xbps-install -Sy ${pkg}`);
            else shellScriptLines.push(`# Install ${pkg} - command not defined for ${distro}`);
            return;
          }

          // echo("text")
          let echoMatch = line.match(/^echo\("(.+)"\)$/);
          if (echoMatch) {
            shellScriptLines.push(`echo ${echoMatch[1]}`);
            return;
          }

          // Unknown fallback
          shellScriptLines.push(`# Unknown command: ${line}`);
        });

        generatedCommand.textContent = shellScriptLines.join("\n");
        show(generatedSection);
      };
    });

    document.getElementById("backToEditor").onclick = () => show(editorSection);

    document.getElementById("copyBtn").onclick = () => {
      navigator.clipboard.writeText(generatedCommand.textContent).then(() => {
        alert("Copied to clipboard! 😊");
      });
    };

    document.getElementById("createAnotherBtn").onclick = () => {
      editor.setValue('');
      show(editorSection);
    };

    const overlay = document.getElementById("overlay");
    document.getElementById("testDistroBtn").onclick = () => {
      overlay.style.display = "flex";
    };
    document.getElementById("overlayClose").onclick = () => {
      overlay.style.display = "none";
    };
  </script>
</body>
</html>
